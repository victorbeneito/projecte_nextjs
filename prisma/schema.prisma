// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql" // Para MariaDB
  url      = env("DATABASE_URL")
}

model Pedido {
  id                Int               @id @default(autoincrement())
  fecha             DateTime          @default(now())
  clienteNombre     String
  clienteEmail      String
  clienteTelefono   String?
  direccion         String
  ciudad            String
  cp                String?
  metodoEnvio       String
  costeEnvio        Decimal  @default(0.0) @db.Decimal(10,2)
  metodoPago        String
  total             Decimal  @db.Decimal(10,2)
  estado            String            @default("pendiente")

  detalles          DetallePedido[]   @relation("PedidoDetalles")

  @@index([clienteEmail])
  @@index([estado])

  @@map("pedidos")
}

model DetallePedido {
  id               Int        @id @default(autoincrement())
  pedidoId         Int
  productoId       String?
  nombreProducto   String
  cantidad         Int        @default(1)
  precioUnitario   Decimal  @default(0.0) @db.Decimal(10,2)
  subtotal         Decimal  @default(0.0) @db.Decimal(10,2)

  pedido           Pedido     @relation("PedidoDetalles", fields: [pedidoId], references: [id])

  @@map("detalles_pedido")
}
